<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Confía - Solicita tu viaje</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 480px;
    margin: auto;
    padding: 10px;
    background: #f2f2f2;
  }
  h1, h2 {
    text-align: center;
    color: #004080;
  }
  label {
    display: block;
    margin-top: 12px;
    font-weight: bold;
  }
  input, select {
    width: 100%;
    padding: 8px;
    margin-top: 4px;
    border-radius: 5px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  button {
    margin-top: 20px;
    width: 100%;
    background-color: #004080;
    color: white;
    padding: 12px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover {
    background-color: #003060;
  }
  .conductores {
    margin-top: 20px;
    background: white;
    padding: 15px;
    border-radius: 10px;
  }
  .conductor-item {
    margin-bottom: 10px;
  }
  .whatsapp-btn {
    background: #25d366;
    color: white;
    padding: 6px 10px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    font-size: 14px;
  }
  #error {
    color: red;
    margin-top: 8px;
    font-weight: bold;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Confía - Servicio de Viajes</h1>

<div class="conductores">
  <h2>Conductores disponibles</h2>
  <div class="conductor-item">
    <strong>Cristián González</strong><br />
    <a class="whatsapp-btn" href="https://wa.me/56920142327" target="_blank">WhatsApp</a>
  </div>
  <div class="conductor-item">
    <strong>Juan Pérez</strong><br />
    <a class="whatsapp-btn" href="https://wa.me/56912345678" target="_blank">WhatsApp</a>
  </div>
  <div class="conductor-item">
    <strong>María López</strong><br />
    <a class="whatsapp-btn" href="https://wa.me/56987654321" target="_blank">WhatsApp</a>
  </div>
</div>

<h2>Solicita tu viaje</h2>
<form id="solicitudForm">
  <label for="rut">RUT (sin puntos ni guion):</label>
  <input type="text" id="rut" name="rut" placeholder="123456789" required />

  <label for="clavePersonal">Clave Personal:</label>
  <input type="text" id="clavePersonal" name="clavePersonal" placeholder="Clave personal" required />

  <label for="nombre">Nombre completo:</label>
  <input type="text" id="nombre" name="nombre" placeholder="Nombre se llenará automáticamente" readonly />

  <div id="error"></div>

  <label for="telefono">Teléfono (con código país):</label>
  <input type="tel" id="telefono" name="telefono" placeholder="+56912345678" required />

  <label for="origen">Lugar de partida:</label>
  <input type="text" id="origen" name="origen" placeholder="Dirección o referencia" required />

  <label for="destino">Destino:</label>
  <input type="text" id="destino" name="destino" placeholder="Dirección o referencia" required />

  <label for="conductor">Selecciona conductor:</label>
  <select id="conductor" name="conductor" required>
    <option value="" disabled selected>-- Elige un conductor --</option>
    <option value="56920142327">Cristián González</option>
    <option value="56912345678">Juan Pérez</option>
    <option value="56987654321">María López</option>
  </select>

  <button type="submit">Enviar solicitud por WhatsApp</button>
</form>

<script>
  const pasajeros = [
    { rut: "123456789", clave: "Azul123", nombre: "Pedro Ramirez" },
    { rut: "987654321", clave: "Rojo456", nombre: "Maria Soto" },
    { rut: "111222333", clave: "Verde789", nombre: "Juan Diaz" },
  ];

  const rutInput = document.getElementById("rut");
  const claveInput = document.getElementById("clavePersonal");
  const nombreInput = document.getElementById("nombre");
  const errorDiv = document.getElementById("error");

  function validarDatos() {
    const rut = rutInput.value.trim();
    const clave = claveInput.value.trim();

    if (rut === "" || clave === "") {
      errorDiv.textContent = "";
      nombreInput.value = "";
      return false;  // No validar hasta que haya ambos datos
    }

    const pasajero = pasajeros.find(p => p.rut === rut && p.clave === clave);

    if (pasajero) {
      nombreInput.value = pasajero.nombre;
      errorDiv.textContent = "";
      return true;
    } else {
      nombreInput.value = "";
      errorDiv.textContent = "RUT o Clave Personal incorrectos.";
      return false;
    }
  }

  rutInput.addEventListener("input", validarDatos);
  claveInput.addEventListener("input", validarDatos);

  document.getElementById("solicitudForm").addEventListener("submit", function(e) {
    if (!validarDatos()) {
      e.preventDefault();
      alert("Por favor verifica que el RUT y la Clave Personal sean correctos.");
    } else {
      // Aquí continúa el envío a WhatsApp si todo es correcto
      const nombre = nombreInput.value.trim();
      const telefono = document.getElementById('telefono').value.trim();
      const origen = document.getElementById('origen').value.trim();
      const destino = document.getElementById('destino').value.trim();
      const conductorTelefono = document.getElementById('conductor').value;

      const mensaje = 
        `Hola, soy ${nombre}.%0A` +
        `Quiero solicitar un viaje desde: ${origen}%0A` +
        `Hasta: ${destino}%0A` +
        `Mi teléfono de contacto es: ${telefono}%0A` +
        `Por favor confirma tu disponibilidad. ¡Gracias!`;

      const urlWhatsApp = `https://wa.me/${conductorTelefono}?text=${mensaje}`;
      window.open(urlWhatsApp, '_blank');
    }
  });
</script>

</body>
</html>
